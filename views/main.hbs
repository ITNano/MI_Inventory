
<div id = "inventory">
	<div class = "inventory-header">Inventarium</div>
	<div id = "inventory-internal">
		<div class = "inventory-item"><div class = "inventory-item-icon"><div id = "inventory-gold-amount">5</div></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
		<div class = "inventory-item"><div class = "inventory-item-icon"></div></div>
	</div>
</div>

<script>
	var socket = io();
	socket.on('items', reloadItems);
	socket.on('achievement', announceAchievement);
	socket.on('money', updateMoney);
	socket.on('visible', setVisibility);
	
	function getNumberOfVisibleSlots(nbrOfItems){
		if (nbrOfItems < 4) return 10;
		else if (nbrOfItems < 9) return 10;
		else if (nbrOfItems < 14) return 15;
		else if (nbrOfItems < 23) return 24;
		else return 28;
	}
	
	function reloadItems(items){
		let allItems = document.getElementsByClassName("inventory-item");
		
		// Hide all unused item rows
		let itemMaxIndex = getNumberOfVisibleSlots(items.length);
		for (let i = 0; i<allItems.length; i++){
			allItems[i].style.display = i < itemMaxIndex ? "block" : "none";
		}
		
		// Populate with icons
		for (let i = 0; i<allItems.length-1; i++) {
			let url = "";
			if (i < items.length){
				url = "url('/imgs/" + items[i] + ".png')";
			}
			
			allItems[i+1].firstChild.style.backgroundImage = url;
		}
		
		// Ugly hack to allow many items, didnt wanna fight with flexbox.
		let className = "";
		if (items.length >= 23) className = "superlarge";
		else if (items.length > 13) className = "large";
		document.getElementById("inventory-internal").className = className;
	}
	
	function updateMoney(amount){
		document.getElementById('inventory-gold-amount').innerHTML = amount;
	}
	
	function setVisibility(visible){
		document.getElementById("inventory").style.display = visible ? "block" : "none";
	}
	
	function announceAchievement(achievement){
		console.log('Got an achievement!');
		console.log(achievement.title + ': ' + achievement.description);
	}
	
</script>